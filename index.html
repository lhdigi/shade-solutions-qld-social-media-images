<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shade Solutions QLD - Local Image Tracker</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-gray-50">
<div id="root"></div>

<script type="text/babel">
const { useState } = React;

// Icons
const Plus = () => (<span className="font-bold text-xl">+</span>);
const X = () => (<span className="font-bold text-red-600">√ó</span>);
const CheckCircle = () => (<span className="text-green-600 font-bold">‚úî</span>);
const AlertCircle = () => (<span className="text-yellow-600 font-bold">!</span>);
const ThumbsUp = () => (<span className="text-green-600 font-bold">üëç</span>);
const ThumbsDown = () => (<span className="text-red-600 font-bold">üëé</span>);

function LocalTracker() {
    const [images, setImages] = useState([]);
    const [newEntry, setNewEntry] = useState({ filename: '', suggestedTopic: '', imageFile: null, imagePreview: null });

    const handleImageUpload = (e) => {
        const file = e.target.files[0];
        if (!file) return;

        if (file.size > 5 * 1024 * 1024) { // 5MB limit
            alert("Image too large! Max 5MB.");
            return;
        }

        const reader = new FileReader();
        reader.onloadend = () => {
            setNewEntry({
                ...newEntry,
                imageFile: file,
                imagePreview: reader.result,
                filename: newEntry.filename || file.name
            });
        };
        reader.readAsDataURL(file);
    };

    const removeImage = () => {
        setNewEntry({ filename: '', suggestedTopic: '', imageFile: null, imagePreview: null });
    };

    const addImage = () => {
        if (!newEntry.filename || !newEntry.imagePreview) {
            alert("Please add a filename and upload an image.");
            return;
        }

        setImages([{ 
            id: Date.now(), 
            ...newEntry, 
            approvalStatus: null, 
            productName: '', 
            supplier: '', 
            reasonForInstall: '', 
            additionalNotes: '', 
            completed: false 
        }, ...images]);

        setNewEntry({ filename: '', suggestedTopic: '', imageFile: null, imagePreview: null });
    };

    const handleApproval = (id, approved) => {
        setImages(images.map(img => img.id === id ? { ...img, approvalStatus: approved } : img));
    };

    const updateImage = (id, field, value) => {
        setImages(images.map(img => img.id === id ? { ...img, [field]: value } : img));
    };

    const markAsCompleted = (id) => {
        setImages(images.map(img => img.id === id ? { ...img, completed: true } : img));
    };

    const deleteImage = (id) => {
        if (!confirm("Delete this image?")) return;
        setImages(images.filter(img => img.id !== id));
    };

    return (
        <div className="min-h-screen p-6 max-w-4xl mx-auto">
            <h1 className="text-3xl font-bold mb-4">Shade Solutions QLD - Local Image Tracker</h1>

            {/* Add New Image */}
            <div className="bg-white p-4 rounded-lg shadow mb-6">
                <h2 className="font-semibold mb-2">Add New Image</h2>

                <div className="mb-4">
                    {newEntry.imagePreview ? (
                        <div className="relative inline-block">
                            <img src={newEntry.imagePreview} alt="Preview" className="h-48 w-auto rounded"/>
                            <button onClick={removeImage} className="absolute top-1 right-1 p-1 bg-white rounded-full shadow">
                                <X />
                            </button>
                        </div>
                    ) : (
                        <label className="flex flex-col items-center justify-center w-full h-48 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100">
                            <span className="text-gray-500">Click or drag to upload image (max 5MB)</span>
                            <input type="file" className="hidden" accept="image/*" onChange={handleImageUpload}/>
                        </label>
                    )}
                </div>

                <input type="text" placeholder="Filename *" className="border p-2 rounded w-full mb-2"
                    value={newEntry.filename} onChange={(e)=>setNewEntry({...newEntry, filename: e.target.value})}/>
                <input type="text" placeholder="Suggested Topic" className="border p-2 rounded w-full mb-2"
                    value={newEntry.suggestedTopic} onChange={(e)=>setNewEntry({...newEntry, suggestedTopic: e.target.value})}/>

                <button onClick={addImage} className="bg-blue-600 text-white px-4 py-2 rounded flex items-center gap-2">
                    <Plus /> Add Image
                </button>
            </div>

            {/* Image List */}
            {images.length === 0 && <p className="text-gray-500">No images yet.</p>}

            {images.map(img => (
                <div key={img.id} className={`bg-white p-4 rounded shadow mb-4 border-l-4 ${img.completed ? 'border-green-500' : 'border-yellow-500'}`}>
                    <div className="flex justify-between mb-2">
                        <div className="flex items-center gap-2">
                            <span>{img.completed ? <CheckCircle /> : <AlertCircle />}</span>
                            <strong>{img.filename}</strong>
                        </div>
                        <button onClick={()=>deleteImage(img.id)} className="text-red-500">Delete</button>
                    </div>

                    {img.imagePreview && <img src={img.imagePreview} alt={img.filename} className="w-full h-auto rounded mb-2"/>}

                    {img.approvalStatus === null && !img.completed && (
                        <div className="mb-2">
                            <p>Approve upload?</p>
                            <div className="flex gap-2 mt-1">
                                <button onClick={()=>handleApproval(img.id,true)} className="bg-green-600 text-white px-2 py-1 rounded flex items-center gap-1"><ThumbsUp /> Yes</button>
                                <button onClick={()=>handleApproval(img.id,false)} className="bg-red-600 text-white px-2 py-1 rounded flex items-center gap-1"><ThumbsDown /> No</button>
                            </div>
                        </div>
                    )}

                    {img.approvalStatus && !img.completed && (
                        <div className="grid grid-cols-1 gap-2 mb-2">
                            <input type="text" placeholder="Product Name" value={img.productName} 
                                onChange={e=>updateImage(img.id,'productName',e.target.value)}
                                className="border p-1 rounded"/>
                            <input type="text" placeholder="Supplier" value={img.supplier} 
                                onChange={e=>updateImage(img.id,'supplier',e.target.value)}
                                className="border p-1 rounded"/>
                            <textarea placeholder="Reason for Install" value={img.reasonForInstall} 
                                onChange={e=>updateImage(img.id,'reasonForInstall',e.target.value)}
                                className="border p-1 rounded"/>
                            <textarea placeholder="Additional Notes" value={img.additionalNotes} 
                                onChange={e=>updateImage(img.id,'additionalNotes',e.target.value)}
                                className="border p-1 rounded"/>
                            <button onClick={()=>markAsCompleted(img.id)} className="bg-green-600 text-white px-2 py-1 rounded flex items-center gap-1">
                                <CheckCircle /> Mark Complete
                            </button>
                        </div>
                    )}

                    {img.completed && (
                        <div className="bg-green-50 p-2 rounded">
                            <p>‚úî Completed</p>
                            {img.productName && <p>Product: {img.productName}</p>}
                            {img.supplier && <p>Supplier: {img.supplier}</p>}
                            {img.reasonForInstall && <p>Reason: {img.reasonForInstall}</p>}
                            {img.additionalNotes && <p>Notes: {img.additionalNotes}</p>}
                        </div>
                    )}
                </div>
            ))}
        </div>
    );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<LocalTracker />);
</script>
</body>
</html>
